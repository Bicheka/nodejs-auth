# Auth Microservice

A lightweight, reusable authentication microservice built with **Express.js**, **PostgreSQL**, and **JWT authentication**. It supports:

* Email + Password sign up & login
* OAuth providers (Google, GitHub, LinkedIn, etc.)
* Access tokens + Refresh tokens
* Session-based or token-based implementations
* Reusable architecture so any app (web, mobile, backend) can integrate with your auth server

---

## ğŸš€ Features

* **User Registration & Login** with hashed passwords (bcrypt)
* **OAuth Login** (Google, GitHub, etc.) via Passport or custom handlers
* **JWT Tokens** (access + refresh)
* **Session support** (optional)
* **PostgreSQL database migrations**
* **Modular folder structure** for easy scaling
* **Can be used by any other service** through simple HTTP endpoints

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ config
â”‚   â”‚   â””â”€â”€ passport.ts
â”‚   â”œâ”€â”€ controllers
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”œâ”€â”€ middlewares
â”‚   â”‚   â””â”€â”€ auth.middleware.ts
â”‚   â”œâ”€â”€ routes
â”‚   â”‚   â””â”€â”€ auth.routes.ts
â”‚   â”œâ”€â”€ services
â”‚   â”‚   â””â”€â”€ auth.service.ts
â”‚   â”œâ”€â”€ db
â”‚   â”‚   â”œâ”€â”€ migrations
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ server.ts
â”œâ”€â”€ sql
â”‚   â””â”€â”€ *.sql
â”œâ”€â”€ .env
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## ğŸ§  How It Works

### 1. User Authentication Flow

* User signs up or logs in.
* Server validates credentials.
* Server returns:

  * **Access Token (short-lived)**
  * **Refresh Token (long-lived)**
* Client stores tokens (HTTP-only cookie or secure storage).

### 2. OAuth Flow

* Client redirects user to Google/GitHub.
* Provider returns a `code`.
* Server exchanges the `code` for user info + tokens.
* Server creates or finds a user.
* Server returns access/refresh tokens.

---

## ğŸ› ï¸ Installation

### 1. Clone the repo

```
git clone https://github.com/yourname/auth-microservice.git
cd auth-microservice
```

### 2. Install dependencies

```
npm install
```

### 3. Environment variables

Create a `.env` file:

```
PORT=4000
DATABASE_URL=postgresql://postgres:password@localhost:5432/auth
JWT_ACCESS_SECRET=your_access_secret
JWT_REFRESH_SECRET=your_refresh_secret
GOOGLE_CLIENT_ID=your_id
GOOGLE_CLIENT_SECRET=your_secret
GITHUB_CLIENT_ID=your_id
GITHUB_CLIENT_SECRET=your_secret
```

---

## ğŸ—„ï¸ Database Setup

Run the SQL migrations:

```
npm run migrate
```

(or use your custom migration script)

---

## â–¶ï¸ Running the Server

```
npm run dev
```

Server will start at:

```
http://localhost:4000
```

---

## ğŸ”— API Endpoints

### **POST /auth/register**

Create account.

```
{
  "email": "test@example.com",
  "password": "123456"
}
```

### **POST /auth/login**

Login with email + password.

### **POST /auth/refresh**

Get new access token.

### **GET /auth/google**

Redirects to Google login.

### **GET /auth/google/callback**

OAuth callback.

### **GET /auth/me**

Returns authenticated user.

---

## ğŸ§© Integrating With Other Apps

Any app can authenticate against this microservice.

Example (frontend):

```
POST https://auth.yourdomain.com/auth/login
```

Receive tokens â†’ store â†’ use for API requests.

Backend services can validate JWTs with your public secret.

---

## ğŸ“¦ Future Improvements

* Add rate limiting
* Add email verification
* Add 2FA
* Add admin dashboard

---

## License

MIT
